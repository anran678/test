import torch
import torch.nn as nn

class LearnablePReLU(nn.Module):
    def __init__(self, init_alpha=0.25):
        super().__init__()
        # 定义可学习参数 alpha，初始值为 0.25
        self.alpha = nn.Parameter(torch.tensor(init_alpha, dtype=torch.float32))

    def forward(self, x):
        # 前向传播：正区保持 x，负区用 alpha*x
        return torch.where(x >= 0, x, self.alpha * x)

# 在模型中使用
model = nn.Sequential(
    nn.Linear(784, 256),
    LearnablePReLU(),  # 替代普通激活函数
    nn.Linear(256, 10)
)
